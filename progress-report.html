<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>progress report</title>
    <link rel="stylesheet" href="https://stackedit.io/style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
    Prism.plugins.autoloader.languages_path =
    "https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/";
    </script>
    <style>
    @media print {
    .page-break { break-before: page; }
    p {
    break-inside: avoid;
    page-break-inside: avoid;
    orphans: 3;
    widows: 3;
    }
    table {
    display: table;
    break-before: avoid;
    page-break-before: avoid;
    break-inside: auto;
    page-break-inside: auto;
    }
    pre { white-space: pre-wrap; overflow: visible; }
    pre code {
    white-space: pre-wrap;
    overflow-wrap: anywhere;
    word-break: break-word;
    }
    thead { display: table-header-group; }
    tfoot { display: table-footer-group; }
    tbody {
    break-inside: auto;
    page-break-inside: auto;
    }
    tr {
    break-inside: avoid;
    page-break-inside: avoid;
    }
    th, td {
    break-inside: auto;
    page-break-inside: auto;
    overflow-wrap: normal;
    word-break: normal;
    hyphens: none;
    white-space: normal;
    }
    h1, h2, h3, h4, h5, h6 {
    break-after: avoid;
    page-break-after: avoid;
    orphans: 3;
    widows: 3;
    }
    h1 + *, h2 + *, h3 + *, h4 + *, h5 + *, h6 + * {
    break-before: avoid;
    page-break-before: avoid;
    }
    h1#references, h1#appendix {
    break-before: page;
    page-break-before: always;
    break-after: avoid;
    page-break-after: avoid;
    }
    h1#references + *, h1#appendix + * {
    break-before: avoid;
    page-break-before: avoid;
    }
    img {
    max-width: 100%;
    height: auto;
    object-fit: contain;
    max-height: calc(100vh - 2cm);
    break-inside: avoid;
    page-break-inside: avoid;
    }
    figure {
    break-inside: avoid;
    page-break-inside: avoid;
    }
    pre, code { max-width: 100%; }
    pre {
    white-space: pre-wrap;
    overflow-wrap: anywhere;
    word-break: break-word;
    }
    code {
    white-space: pre-wrap;
    overflow-wrap: anywhere;
    word-break: break-word;
    }
    .page-toc-wrapper .stackedit__toc {
    border: 1px solid rgba(0,0,0,.08);
    border-radius: 6px;
    padding: .5rem 0;
    margin: 1rem 0 1.5rem 0;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    }
    .page-toc-wrapper .stackedit__toc ul { padding: 0; }
    .page-toc-wrapper .stackedit__toc li { display: block; }
    .page-toc-wrapper .stackedit__toc a {
    display: block;
    color: inherit;
    text-decoration: none;
    margin: .5rem 0;
    padding: .5rem 1rem;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    }
    .page-toc-wrapper .stackedit__toc ul ul {
    color: #888;
    font-size: .9em;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    }
    .page-toc-wrapper .stackedit__toc ul ul a {
    margin: 0;
    padding: .1rem 1.5rem;
    }
    .page-toc-wrapper .stackedit__toc ul ul ul {
    color: #9a9a9a;
    font-size: .85em;
    }
    .page-toc-wrapper .stackedit__toc ul ul ul a {
    padding: .05rem 2rem;
    }
    .print-table-fit {
    max-width: 100%;
    transform-origin: top left;
    }
    }
    </style>
    <style>
    @media screen {
    table {
    display: block;
    overflow-x: auto;
    max-width: 100%;
    }
    }
    .page-toc-wrapper .stackedit__toc {
    border: 1px solid rgba(0,0,0,.08);
    border-radius: 6px;
    padding: .5rem 0;
    margin: 1rem 0 1.5rem 0;
    }
    .page-toc-wrapper .stackedit__toc ul { padding: 0; }
    .page-toc-wrapper .stackedit__toc li { display: block; }
    .page-toc-wrapper .stackedit__toc a {
    display: block;
    color: inherit;
    text-decoration: none;
    margin: .5rem 0;
    padding: .5rem 1rem;
    }
    .page-toc-wrapper .stackedit__toc ul ul {
    color: #888;
    font-size: .9em;
    }
    .page-toc-wrapper .stackedit__toc ul ul a {
    margin: 0;
    padding: .1rem 1.5em;
    }
    .page-toc-wrapper .stackedit__toc ul ul ul {
    color: #9a9a9a;
    font-size: .85em;
    }
    .page-toc-wrapper .stackedit__toc ul ul ul a {
    padding: .05rem 2rem;
    }
    .page-toc-wrapper .stackedit__toc a:active,
    .page-toc-wrapper .stackedit__toc a:focus,
    .page-toc-wrapper .stackedit__toc a:hover {
    background-color: rgba(0,0,0,.075);
    border-radius: 3px;
    }
    </style>
  </head>
    <body class="stackedit">
      <div class="stackedit__left">
        <div class="stackedit__toc">
          
<ul>
<li><a href="#progress-report-deterministic-ray-tracing-gamma-transport-solver-for-nuclear-waste-burial-safety">Progress Report: Deterministic Ray-Tracing Gamma Transport Solver for Nuclear Waste Burial Safety</a>
<ul>
<li><a href="#abstract">Abstract</a></li>
</ul>
</li>
<li><a href="#motivation-and-context">Motivation and Context</a>
<ul>
<li><a href="#why-this-problem-matters">Why this problem matters</a></li>
<li><a href="#project-goals">Project goals</a></li>
<li><a href="#approach-overview">Approach overview</a></li>
</ul>
</li>
<li><a href="#background-research-and-related-work">Background Research and Related Work</a>
<ul>
<li><a href="#existing-tools-and-ecosystems">Existing tools and ecosystems</a></li>
<li><a href="#determinism-and-gpu-transport">Determinism and GPU transport</a></li>
<li><a href="#geological-disposal-and-domain-context">Geological disposal and domain context</a></li>
</ul>
</li>
<li><a href="#updated-specification-and-requirements">Updated Specification and Requirements</a>
<ul>
<li><a href="#functional-requirements">Functional requirements</a></li>
<li><a href="#non-functional-requirements">Non-functional requirements</a></li>
<li><a href="#changes-from-the-initial-plan">Changes from the initial plan</a>
<ul>
<li><a href="#bgs-data-licensing">BGS Data Licensing</a></li>
<li><a href="#structure-support">Structure Support</a></li>
<li><a href="#solver-structure">Solver Structure</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#progress-to-date">Progress to Date</a>
<ul>
<li><a href="#system-architecture-achieved">System architecture achieved</a></li>
<li><a href="#mathematical-model-and-implementation-mapping">Mathematical model and implementation mapping</a>
<ul>
<li><a href="#uncollided-transport-and-governing-equation">Uncollided transport and governing equation</a></li>
<li><a href="#uncollided-transport-phi_0">Uncollided transport (ϕ0)(\phi_0)(ϕ0​)</a></li>
<li><a href="#first-collision-source-and-single-scatter-phi_1">First-collision source and single scatter (ϕ1)(\phi_1)(ϕ1​)</a></li>
<li><a href="#collision-order-neumann-expansion">Collision-order Neumann expansion</a></li>
<li><a href="#series-convergence-ratio">Series convergence ratio</a></li>
</ul>
</li>
<li><a href="#dashboard-modernization">Dashboard modernization</a></li>
<li><a href="#current-limitations">Current limitations</a></li>
</ul>
</li>
<li><a href="#validation-and-benchmarking">Validation and Benchmarking</a>
<ul>
<li><a href="#what-valid-means-for-this-project">What “valid” means for this project</a></li>
<li><a href="#benchmark-suite-overview">Benchmark suite overview</a></li>
<li><a href="#results-table">Results table</a>
<ul>
<li><a href="#on-gpu">On GPU</a></li>
<li><a href="#on-cpu">On CPU</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#planned-work">Planned Work</a>
<ul>
<li><a href="#prioritized-deliverables">Prioritized deliverables</a></li>
<li><a href="#risks-and-mitigation">Risks and mitigation</a></li>
</ul>
</li>
<li><a href="#example-run">Example Run</a>
<ul>
<li>
<ul>
<li><a href="#test-run-phi1_grid_fine">Test run: phi1_grid_fine</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#appraisal-and-reflection">Appraisal and Reflection</a></li>
<li><a href="#legal-social-ethical-and-professional-considerations">Legal, Social, Ethical, and Professional Considerations</a></li>
<li><a href="#project-management-approach">Project Management Approach</a>
<ul>
<li><a href="#updated-gantt-chart">Updated Gantt Chart</a></li>
<li><a href="#benchmark-results-table">Benchmark results table</a>
<ul>
<li><a href="#tests">Tests</a></li>
<li><a href="#runs">Runs</a></li>
</ul>
</li>
<li><a href="#run-metadata">Run Metadata</a></li>
<li><a href="#project-specifications">Project Specifications</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="stackedit__right">
        <div class="stackedit__html">
          <h1 id="progress-report-deterministic-ray-tracing-gamma-transport-solver-for-nuclear-waste-burial-safety">Progress Report: Deterministic Ray-Tracing Gamma Transport Solver for Nuclear Waste Burial Safety</h1>
<blockquote>
<p>Harmony<br>
Word count <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mn>3900</mn></mrow><annotation encoding="application/x-tex">\approx 3900</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3900</span></span></span></span></span> words (excluding references and appendix).</p>
</blockquote>
<div class="page-toc"></div>
<h2 id="abstract">Abstract</h2>
<p>This project aims at developing a deterministic and auditable gamma-radiation transport solver to support the safety assessment of deep geological disposal of nuclear waste.</p>
<p>The disposal of long-lived radionuclide requires credible modelling of the environmental transport and streaming of the gamma radiation over long time horizons, the goal being to ensure its isolation from the environment under given certainty measures.<br>
To ensure public trust and compliance with regulations, decision regarding the assessment of nuclear waste burial safety requires procedures which are reproducible and explainable<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>. Our program solves targets fixed-source photon transport in 3D voxel geometries as collision-order (Neumann-series) expansion under known uncertainty.</p>
<p>Current iteration implements the core, structured around per-segment analytic integration and accumulation. A two-pass tally pipeline is implemented (segment record emission, then stable sort + ordered reduction) and tested against a benchmark suite. This suite encodes multiple physics sanity checks, convergence tests, and determinism regression tests. Finally, a dashboard for the interpretation of 2D/3D fields and performance counters has also been implemented.</p>
<p>This report documents the current state of the implementation, formalizes the mathematical foundations and convergence properties of the approach, and provides a detailed plan for the remaining work.</p>
<div class="page-break"></div>
<h1 id="motivation-and-context">Motivation and Context</h1>
<h2 id="why-this-problem-matters">Why this problem matters</h2>
<p>Safe disposal of high-level radioactive waste is challenging due to the timescales (10<sup>3</sup> - 10<sup>6</sup> years), which, combined with the many uncertainties factors (radiation, geology, hydrology, heat transfer, chemical transport, erosion…), can contribute to devastating consequences if the radionuclides were to leak to the surrounding environment<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup>. As such, both modelling quality and transparency is a central focus of the problem.<br>
Most national programmes rely on deep geological disposal. However, site characterization and safety cases require a chain of evidence that spans measurement, modelling, and uncertainty management.<sup class="footnote-ref"><a href="#fn2" id="fnref2:1">2</a></sup> In Europe, radioactive waste policy is tied to decommissioning and long-term stewardship, with public funding and oversight frameworks that make traceability and repeatability important for confidence.<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> However, due to their nature, very few of these frameworks are ever conducted to completion due to the time-consuming nature of the realization of such a long chain of evidence, as well as often abandoned due to the constant rise of costs.</p>
<p>Recent events have reinforced that energy security<sup class="footnote-ref"><a href="#fn4" id="fnref4">4</a></sup> and geopolitical risk can rapidly reshape the perceived value and risks of nuclear infrastructure as a mean for independent national energy source.<br>
As such, our approach can contribute to reducing meaningfully the iteration cycle and associated cost of site safety assessment.</p>
<p>Nonetheless, we note that this project does not aim at providing a definitive answer as to if a burial site is suitable and safe or not. This project aims at streamlining a process which so far has been too slow (by hand / MCNP<sup class="footnote-ref"><a href="#fn5" id="fnref5">5</a></sup>) or too inaccurate (pure discretization methods) with the goal of providing nuclear waste experts suitable and realistic data to make an assessment of a nuclear waste site, thus reducing both costs and timelines.</p>
<div class="page-break"></div>
<h2 id="project-goals">Project goals</h2>
<ul>
<li>
<p>Accurate fixed-source gamma transport in 3D voxel geometries</p>
</li>
<li>
<p>Predictable convergence: a controlled approximation hierarchy under fixed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span> inaccuracy stopping criteria</p>
</li>
<li>
<p>Deterministic reproducibility across repeated runs</p>
</li>
<li>
<p>Performance transparency: per-segment cost metrics and visibility into scaling with grid/directions/groups</p>
</li>
<li>
<p>Extensibility to heterogeneous media: voxel-wise material composition and ingestion of real geological datasets</p>
</li>
<li>
<p>Usability: visualization and reporting that supports both expert inspection and non-expert interpretation in sound computing time</p>
</li>
</ul>
<h2 id="approach-overview">Approach overview</h2>
<p>Our engine uses deterministic ray tracing over a Cartesian voxel grid <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="script">O</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathcal{O}, x, y, z, h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathcal" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span></span>. Transport is integrated over each segment (of constant <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Sigma_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>) using closed-form exponential absorption. Tallies are computed by track-length estimators. Scattering is handled via collision-order expansion: the uncollided field is computed first, then a first-collision isotropic volumetric source is derived and transported to obtain the single-scatter field; later work aiming to extend this to higher orders. To retain determinism while exploiting GPU throughput, the implementation avoids unordered atomic tallies: it emits per-segment “record” contributions and performs a stable sort by voxel ID followed by an ordered reduction.</p>
<div class="page-break"></div>
<h1 id="background-research-and-related-work">Background Research and Related Work</h1>
<h2 id="existing-tools-and-ecosystems">Existing tools and ecosystems</h2>
<p>Photon transport is commonly solved via Monte Carlo codes (Geant4, GATE, MCNP-like systems<sup class="footnote-ref"><a href="#fn6" id="fnref6">6</a></sup>) and deterministic methods (discrete ordinates <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">S_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.05764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, method of characteristics, hybrid approaches<sup class="footnote-ref"><a href="#fn7" id="fnref7">7</a></sup>).<br>
Monte Carlo provides high fidelity and flexible physics but can be expensive and produces stochastic uncertainty that must be controlled by sampling.<br>
In contrast, deterministic transport provides deterministic outputs and can converge rapidly for certain regimes, at the cost of potential discretization artefacts and the need to manage angular resolution.</p>
<p>The aim of this project is to provide an implementation of rigorous mathematical background over modular and modern simulation techniques for efficient and accurate productions over very large models: faster than Monte Carlo simulations, more accurate than current discretization methods<sup class="footnote-ref"><a href="#fn8" id="fnref8">8</a></sup>. For cross-section data and photon interaction models, canonical references include PDG summaries and NIST XCOM; these support the later stage of constructing multi-group material libraries.<sup class="footnote-ref"><a href="#fn9" id="fnref9">9</a></sup> <sup class="footnote-ref"><a href="#fn10" id="fnref10">10</a></sup></p>
<h2 id="determinism-and-gpu-transport">Determinism and GPU transport</h2>
<p>A key differentiator of nuclear waste simulation is the strict determinism requirement<sup class="footnote-ref"><a href="#fn11" id="fnref11">11</a></sup>. Many GPU transport implementations use atomic floating-point tallies<sup class="footnote-ref"><a href="#fn12" id="fnref12">12</a></sup>, where scheduling differences can change accumulation order and therefore output.</p>
<p>In a safety workflow, results must be explainable and re-computable by a third party. If a “rerun” can drift by small floating-point differences due to nondeterministic accumulation, it becomes difficult to attribute changes to code, parameters, or genuine physics effects. Furthermore, small drifts may accumulate to large differences over large settings. Therefore, by enforcing a fixed ordering (ray ordering, segment emission ordering, and voxel reduction ordering) the project makes regression testing meaningful: if an output changes, it is assured to be due to an intentional code or parameter change.</p>
<div class="page-break"></div>
<h2 id="geological-disposal-and-domain-context">Geological disposal and domain context</h2>
<p>International guidance and national programmes (such as ANDRA<sup class="footnote-ref"><a href="#fn13" id="fnref13">13</a></sup> in France, IRSN<sup class="footnote-ref"><a href="#fn14" id="fnref14">14</a></sup> studies, or IAEA publications<sup class="footnote-ref"><a href="#fn11" id="fnref11:1">11</a></sup>) emphasize the need for site characterization, environmental modelling, and transparent safety-case argumentation.</p>
<p>While the current solver focuses on radiation transport, the architecture is designed with modularity in mind. As such, given time and resources, more complex modules<sup class="footnote-ref"><a href="#fn15" id="fnref15">15</a></sup> can be implemented.</p>
<div class="page-break"></div>
<h1 id="updated-specification-and-requirements">Updated Specification and Requirements</h1>
<h2 id="functional-requirements">Functional requirements</h2>
<p>From the initial project concept and subsequent research/implementation, the working requirements are:</p>
<ul>
<li>
<p>Fixed-source gamma transport in 3D voxel grids with output fields suitable for analysis and visualization.</p>
</li>
<li>
<p>Collision-order expansion: compute at least <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> (uncollided) and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> (single scatter), then extend to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\phi_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>.</p>
</li>
<li>
<p>Multi-group down scatter coupling for shielding-style problems (high to low energy ordering).</p>
</li>
<li>
<p>Deterministic execution over CPU and GPU.</p>
</li>
<li>
<p>Output schema coherence and general software engineering guidelines: metadata and naming conventions shared across solver, bench harness, and dashboard.</p>
</li>
<li>
<p>Benchmark suite with:</p>
<ul>
<li>Correctness sanity checks (vacuum / homogeneous attenuation),</li>
<li>Convergence tests (angular resolution, grid refinement, collision order),</li>
<li>Determinism regression tests,</li>
<li>Performance counters and NSI/LNSI reporting.</li>
<li>Harder standard non-atomic benchmark tests<sup class="footnote-ref"><a href="#fn16" id="fnref16">16</a></sup> <sup class="footnote-ref"><a href="#fn17" id="fnref17">17</a></sup></li>
<li>Accuracy against known sites</li>
</ul>
</li>
<li>
<p>Visualization dashboard capable of loading runs, selecting fields, and inspecting 2D/3D structure and performance.</p>
</li>
</ul>
<h2 id="non-functional-requirements">Non-functional requirements</h2>
<p>The simulation thus strives to be transparent, robust, maintainable, and usable while retaining its deterministic nature.</p>
<div class="page-break"></div>
<h2 id="changes-from-the-initial-plan">Changes from the initial plan</h2>
<h3 id="bgs-data-licensing">BGS Data Licensing</h3>
<p>BGS data licensing to access datasets was initially refused. However, after some exchanges, academic licence is currently being processed via the university, and may take several weeks (as of the time of writing). The initial plan already outlined this scenario and the mitigating strategy.</p>
<p>Concretely, as the initial access was refused, we approached the generation of the geological media using interpolation procedures (Krigging) based on open-source and freely available borehole, fault/dykes and litho stratigraphic data. This approach introduces many uncertainties regarding the accuracy of the geological interpolation and its structure in the real world. As such, the simulation would need to explicitly state more uncertainty, and the results would hold little to no scientific value as is in regard to the safety assessment. As our scope is mainly axed towards the ray-tracing engine, the geological module would have been downgraded in the specifications to a visualization &amp; approximation module rather than rigorous scientific data.</p>
<p>Furthermore, other options outlined in the project specifications implied switching the “by default” scope of the project to other regions with publicly available data. Although these datasets exist and could be used/licensed, this outcome remained less than ideal.</p>
<p>Luckily, none of them will be necessary for the final implementation, assuming the licensing does not fail. However, due to the delay in data access and double change in specifications, the timeline has been greatly impacted (when the actual BGS datasets is received, all previous geological implementations and code must be disregarded, and that time wasted). But our previous Gantt Chart was made with the possibility of such outcomes, and thus allows for those changes without loss of content.</p>
<h3 id="structure-support">Structure Support</h3>
<p>The initial report mentioned the usage of exclusively BVH data. This idea was theoretically sound, but would in practice render the complexity of the simulation in its current state too high. Considering the performance are already very satisfying, we have found it sensible to not introduce (at least yet) another layer of abstraction. However, the implementation of a BVH or other format structures may be chosen later. The format of the intermediate outputs and cache is far from critical and hot-swappable. Considering how much performance depends on the actual implementation and not solely on theoretical improvements in these contexts, it is best to leave this decision blank for now.</p>
<div class="page-break"></div>
<h3 id="solver-structure">Solver Structure</h3>
<p>The project specification finally mentioned approximating the LBTE through two components:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ψ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo><mo>≈</mo><msub><mi>ψ</mi><mtext>direct</mtext></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>ψ</mi><mtext>scattered</mtext></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">  
\psi(\mathbf{r}, E, \Omega) \approx  
\psi_{\text{direct}}(\mathbf{r}, E, \Omega) +  
\psi_{\text{scattered}}(\mathbf{r}, E, \Omega)  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">direct</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">scattered</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span></span></span></span></span></span></p>
<p>This approach is very akin to what we are doing now, but less abstract. <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mtext>scattered</mtext></msub></mrow><annotation encoding="application/x-tex">\psi_{\text{scattered}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">scattered</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is now computed as:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ψ</mi><mtext>scattered</mtext></msub><mo>=</mo><munder><mo>∑</mo><mrow><mn>1</mn><mo>…</mo><mi>N</mi></mrow></munder><msub><mi>ϕ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\psi_{\text{scattered}}=\sum_{1\dots N}{\phi_n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">scattered</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.34434em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="minner mtight">…</span><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>For some <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span></span> decided based on the input data, and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span> the Neumann decomposition of the LBTE.</p>
<p>It follows that: <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mtext>direct</mtext></msub><mo>=</mo><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\psi_{\text{direct}}=\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">direct</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<div class="page-break"></div>
<h1 id="progress-to-date">Progress to Date</h1>
<h2 id="system-architecture-achieved">System architecture achieved</h2>
<p>The repository is now composed of separate modules:</p>
<ul>
<li>Solver (C++/CUDA): per-segment analytic transport kernels, ray launch strategies (reference voxel emission vs production sweep), deterministic tally/reduction, and IO schema.</li>
<li>Benchmark harness (Python): test registry, run orchestration, caching, metrics, and reporting.</li>
<li>Dashboard (Python): run indexing, volume caching, multi-view visualization (overview/slices/radial/3D/tables).</li>
</ul>
<h2 id="mathematical-model-and-implementation-mapping">Mathematical model and implementation mapping</h2>
<blockquote>
<p>This is where the fun begins</p>
</blockquote>
<h3 id="uncollided-transport-and-governing-equation">Uncollided transport and governing equation</h3>
<p>The steady-state LBTE for neutral particle transport is given as:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><munder><mrow><mi mathvariant="normal">Ω</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ψ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">undefined</mo></munder><mtext>Streaming&nbsp;term</mtext></munder><mo>+</mo><munder><munder><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>ψ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">undefined</mo></munder><mtext>Collision&nbsp;(loss)&nbsp;term</mtext></munder><mspace linebreak="newline"></mspace><mo>=</mo><munder><munder><mrow><msubsup><mo>∫</mo><mn>0</mn><mi mathvariant="normal">∞</mi></msubsup><msub><mo>∫</mo><mrow><mn>4</mn><mi>π</mi></mrow></msub><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><msub><mi>σ</mi><mi>a</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><msup><mi>E</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>→</mo><mi>E</mi><mo separator="true">,</mo><msup><mi mathvariant="normal">Ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>→</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>ψ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><msup><mi>E</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi mathvariant="normal">Ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi mathvariant="normal">d</mi><msup><mi>E</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">d</mi><msup><mi mathvariant="normal">Ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><mo stretchy="true">undefined</mo></munder><mtext>Scattering&nbsp;(gain)&nbsp;term</mtext></munder><mo>+</mo><munder><munder><mrow><mi>S</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">undefined</mo></munder><mtext>Source&nbsp;term</mtext></munder></mrow><annotation encoding="application/x-tex">
\underbrace{\Omega \cdot \nabla \psi(\mathbf{r}, E, \Omega)}_{\text{Streaming term}}  
+  
\underbrace{\Sigma_t(\mathbf{r}, E) \cdot \psi(\mathbf{r},E,  \Omega)}_{\text{Collision (loss) term}} 
\newline =
\underbrace{\int_0^{\infty} \int_{4\pi} \Sigma (\sigma_a) \cdot (\mathbf{r}, E' \to E, \Omega' \to \Omega) \cdot \psi(\mathbf{r}, E', \Omega')\space\mathrm{d}E' \mathrm{d}\Omega' } _{\text{Scattering (gain) term}}   +  
\underbrace{S(\mathbf{r}, E, \Omega)}_{\text{Source term}}  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.46244em; vertical-align: -1.71244em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -1.42367em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Streaming&nbsp;term</span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="svg-align" style="top: -2.102em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Ω</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.898em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.71244em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.548em; vertical-align: -1.798em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -1.377em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Collision&nbsp;(loss)&nbsp;term</span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="svg-align" style="top: -2.102em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.898em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.798em;"><span class=""></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.87424em; vertical-align: -2.45995em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.41429em;"><span class="" style="top: -1.12934em;"><span class="pstrut" style="height: 3.41429em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Scattering&nbsp;(gain)&nbsp;term</span></span></span></span></span><span class="" style="top: -3.41429em;"><span class="pstrut" style="height: 3.41429em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.41429em;"><span class="svg-align" style="top: -1.85434em;"><span class="pstrut" style="height: 3.41429em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span class="" style="top: -3.41429em;"><span class="pstrut" style="height: 3.41429em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol large-op" style="margin-right: 0.44445em; position: relative; top: -0.001125em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.41429em;"><span class="" style="top: -1.78805em; margin-left: -0.44445em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.8129em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.91195em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right: 0.44445em; position: relative; top: -0.001125em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.78805em; margin-left: -0.44445em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.91195em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Ω</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">&nbsp;</span><span class="mord mathrm">d</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathrm">d</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55995em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45995em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.32633em; vertical-align: -1.57633em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -1.42367em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Source&nbsp;term</span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="svg-align" style="top: -2.102em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height: 0.548em;"><svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.898em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.57633em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi></mrow><annotation encoding="application/x-tex">\psi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span></span></span></span></span> is the angular flux, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Sigma_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> the total macroscopic cross-section, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\Sigma_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> the differential scattering kernel, and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span></span></span></span></span> the external source.</p>
<p>In the present work we consider mono-energetic (or energy-group dependant) gamma transport with isotropic scattering. Isotropic scattering implies that the probability of re-emission after a collision is independent of direction, thus the scattering term reduces to:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><msup><mi>E</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">!</mo><mo>→</mo><mo stretchy="false">!</mo><mi>E</mi><mo separator="true">,</mo><msup><mi mathvariant="normal">Ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">!</mo><mo>→</mo><mo stretchy="false">!</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo> <mi>δ</mi><mo stretchy="false">(</mo><msup><mi>E</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>−</mo><mi>E</mi><mo stretchy="false">)</mo> <mfrac><mn>1</mn><mrow><mn>4</mn><mi>π</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\Sigma_s(\mathbf{r},E'!\to!E,\Omega'!\to!\Omega)
\Sigma_s(\mathbf{r})\,\delta(E'-E)\,\frac{1}{4\pi}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">!</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height: 0.996332em; vertical-align: -0.19444em;"></span><span class="mclose">!</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">!</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mclose">!</span><span class="mord">Ω</span><span class="mclose">)</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.00744em; vertical-align: -0.686em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">π</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>This removes angular coupling from the kernel and replaces it with dependence on the scalar flux:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><mrow><mn>4</mn><mi>π</mi></mrow></msub><mi>ψ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo> <mi mathvariant="normal">d</mi><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">
\phi(\mathbf{r})=\int_{4\pi}\psi(\mathbf{r},\Omega)\,\mathrm{d}\Omega
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.27195em; vertical-align: -0.91195em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right: 0.44445em; position: relative; top: -0.001125em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.78805em; margin-left: -0.44445em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.91195em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathrm">d</span><span class="mord">Ω</span></span></span></span></span></span></p>
<p>which is the angular integral of the flux. Physically, isotropic scattering represents loss of directional memory at each interaction; mathematically, it converts the integro-differential scattering term into a local source relative to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span>.</p>
<p>Under these assumptions, the LBTE becomes</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ψ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo> <mi>ψ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo separator="true">,</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo></mrow><mrow><mn>4</mn><mi>π</mi></mrow></mfrac> <mi>ϕ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo></mrow><mrow><mn>4</mn><mi>π</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\Omega \cdot \nabla \psi(\mathbf{r},\Omega) -   \Sigma_t(\mathbf{r})\,\psi(\mathbf{r},\Omega)  
    =  
    \frac{\Sigma_s(\mathbf{r})}{4\pi}\,\phi(\mathbf{r})
\frac{q(\mathbf{r})}{4\pi}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ω</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.113em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">π</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">π</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> is an external isotropic source density. This equation is linear and physically transparent: particles stream along straight lines, are removed at rate <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Sigma_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, and are replenished by both external emission and isotropic re-emission from scattering.</p>
<h3 id="uncollided-transport-phi_0">Uncollided transport <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\phi_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></h3>
<p>The uncollided contribution corresponds to the zeroth collision-order term of the LBTE solution, obtained by neglecting the scattering source. This separation is physically meaningful: <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> represents radiation that travels directly from the source to a point without any interaction.</p>
<p>Along a characteristic (ray) in direction <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Ω</span></span></span></span></span>, parameterized by path length <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">s</span></span></span></span></span>, the uncollided angular flux satisfies:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">d</mi><msub><mi>ψ</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">d</mi><mi>s</mi></mrow></mfrac><mo>−</mo><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo> <msub><mi>ψ</mi><mn>0</mn></msub><mo separator="true">,</mo><mspace width="2em"></mspace><msub><mi>ψ</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>ψ</mi><mtext>in</mtext></msub></mrow><annotation encoding="application/x-tex">
\frac{\mathrm{d}\psi_0}{\mathrm{d}s}
-\Sigma_t(\mathbf{r}(s))\,\psi_0,  
\qquad  
\psi_0(0)=\psi_{\text{in}} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathrm">d</span><span class="mord mathnormal">s</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathrm">d</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>As our voxels are built over homogenous composition by design, material coefficients are constant, yielding the exact solution:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ψ</mi><mtext>out</mtext></msub><mo>=</mo><msub><mi>ψ</mi><mtext>in</mtext></msub> <msup><mi>e</mi><mrow><mo>−</mo><mi>τ</mi></mrow></msup><mo separator="true">,</mo><mspace width="2em"></mspace><mi>τ</mi><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>d</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">  
\psi_{\text{out}}=\psi_{\text{in}}\,e^{-\tau},  
\qquad  
\tau=\Sigma_t,ds 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.01577em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.821331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span></span></span></span></span></span></p>
<p>Angular integrals are approximated using deterministic quadrature. In implementation, we evolve the quadrature-weighted intensity</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mi mathvariant="normal">Ω</mi></msub><mo>:</mo><mo>=</mo><msub><mi>w</mi><mi mathvariant="normal">Ω</mi></msub> <msub><mi>ψ</mi><mi mathvariant="normal">Ω</mi></msub></mrow><annotation encoding="application/x-tex">  
I_\Omega := w_\Omega\,\psi_\Omega
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>so quadrature weights are carried explicitly through the transport and tally operations. The segment update becomes:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>out</mtext></msub><mo>=</mo><msub><mi>I</mi><mtext>in</mtext></msub> <msup><mi>e</mi><mrow><mo>−</mo><mi>τ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
I_{\text{out}} = I_{\text{in}}\,e^{-\tau}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.971331em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.821331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>The scalar flux is accumulated using a track-length estimator, which exploits the geometric interpretation of scalar flux as the total path length travelled by particles per unit volume. For a ray segment of length <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ds</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span></span></span></span></span> crossing a voxel of volume <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.22222em;">V</span></span></span></span></span>,</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>ϕ</mi><mn>0</mn></msub><mo>=</mo><mfrac><mrow><msub><mi>I</mi><mtext>avg</mtext></msub><mo separator="true">,</mo><mi>d</mi><mi>s</mi></mrow><mi>V</mi></mfrac><mo separator="true">,</mo><mspace width="2em"></mspace><msub><mi>I</mi><mtext>avg</mtext></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>I</mi><mtext>in</mtext></msub><mo>−</mo><msub><mi>I</mi><mtext>out</mtext></msub></mrow><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mi>d</mi><mi>s</mi></mrow></mfrac></mstyle><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>I</mi><mtext>in</mtext></msub><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">  
\Delta \phi_0 = \frac{I_{\text{avg}},ds}{V},  
\qquad  
I_{\text{avg}}=  
\begin{cases}  
\dfrac{I_{\text{in}}-I_{\text{out}}}{\Sigma_t ds}, &amp; \Sigma_t&gt;0,\\ 
I_{\text{in}}, &amp; \Sigma_t=0,  \end{cases}  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.22222em;">V</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">avg</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">avg</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.63633em; vertical-align: -1.56817em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.49999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -2.49199em;"><span class="pstrut" style="height: 3.15em;"></span><span class="" style="height: 0.016em; width: 0.889em;"><svg width="0.889em" height="0.016em" style="width:0.889em" viewBox="0 0 889 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"></path></svg></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.29201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="" style="height: 0.016em; width: 0.889em;"><svg width="0.889em" height="0.016em" style="width:0.889em" viewBox="0 0 889 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"></path></svg></span></span><span class="" style="top: -4.30002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.06817em;"><span class="" style="top: -4.06817em;"><span class="pstrut" style="height: 3.36033em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span class="" style="top: -2.22417em;"><span class="pstrut" style="height: 3.36033em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.56817em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.06817em;"><span class="" style="top: -4.06817em;"><span class="pstrut" style="height: 3.36033em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span><span class="" style="top: -2.22417em;"><span class="pstrut" style="height: 3.36033em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.56817em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>where the second branch corresponds to the exact vacuum limit. Deterministic voxel traversal and segment ordering are enforced using a DDA<sup class="footnote-ref"><a href="#fn18" id="fnref18">18</a></sup> algorithm, ensuring reproducibility without stochastic noise in an efficient implementation.</p>
<blockquote>
<p>On a higher-level note, this is a very fast implementation of per-voxel attenuation following Beer-Lambert<sup class="footnote-ref"><a href="#fn19" id="fnref19">19</a></sup><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mo>=</mo><msub><mi>I</mi><mn>0</mn></msub><msup><mi>e</mi><mrow><mo>−</mo><mi>d</mi> <msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">I=I_0 e^{-d \, \Sigma_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04911em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">d</span><span class="mspace mtight" style="margin-right: 0.195167em;"></span><span class="mord mtight"><span class="mord mtight">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
</blockquote>
<h3 id="first-collision-source-and-single-scatter-phi_1">First-collision source and single scatter <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\phi_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></h3>
<p>For isotropic scattering, the first-collision source represents particles that travel uncollided to a point and then undergo their first interaction. It is given by<sup class="footnote-ref"><a href="#fn20" id="fnref20">20</a></sup></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo> <msub><mi>ϕ</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">  
q_1(\mathbf{r}) = \Sigma_s(\mathbf{r})\,\phi_0(\mathbf{r})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span></span></span></span></span></span></p>
<p>This quantity has a clear physical interpretation as an internal volumetric source generated by the uncollided field. In implementation, since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is accumulated incrementally, the source is updated segment-by-segment via <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>q</mi><mn>1</mn></msub><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub> <mi mathvariant="normal">Δ</mi><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\Delta q_1=\Sigma_s\,\Delta\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, which is algebraically equivalent to forming <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">q_1=\Sigma_s\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> after the sweep.</p>
<p>The single-scattered field <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is obtained by solving the LBTE with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>4</mn><mi>π</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q_1/(4\pi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span></span></span></span></span> as an isotropic source:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><msub><mi>ψ</mi><mn>1</mn></msub><mo>−</mo><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><msub><mi>ψ</mi><mn>1</mn></msub><mo>=</mo><mfrac><msub><mi>q</mi><mn>1</mn></msub><mrow><mn>4</mn><mi>π</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \Omega \cdot \nabla \psi_1 -   \Sigma_t \psi_1  =  
    \frac{q_1}{4\pi}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">∇</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.79356em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">π</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>Two deterministic implementations of this transport operator were conducted: a reference voxel-emission method and a boundary sweep with internal source. Both solve the same discretized LBTE operator and differ only in how rays are launched</p>
<p>For the quadrature-weighted intensity, transport within a voxel satisfies</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">d</mi><msub><mi>I</mi><mi mathvariant="normal">Ω</mi></msub></mrow><mrow><mi mathvariant="normal">d</mi><mi>s</mi></mrow></mfrac><mo>−</mo><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><msub><mi>I</mi><mi mathvariant="normal">Ω</mi></msub><mo>+</mo><mfrac><mrow><msub><mi>q</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo></mrow><mrow><mn>4</mn><mi>π</mi></mrow></mfrac> <msub><mi>w</mi><mi mathvariant="normal">Ω</mi></msub></mrow><annotation encoding="application/x-tex">
\frac{\mathrm{d}I_\Omega}{\mathrm{d}s}
-\Sigma_t I_\Omega  
+  
\frac{q_1(\mathbf{r})}{4\pi}\,w_\Omega
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathrm">d</span><span class="mord mathnormal">s</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathrm">d</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.113em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">π</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>which admits an exact closed-form update over each segment, then deposited using the same track-length estimator as for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p>
<h3 id="collision-order-neumann-expansion">Collision-order Neumann expansion</h3>
<p>Mathematically, the LBTE can be written in operator<sup class="footnote-ref"><a href="#fn21" id="fnref21">21</a></sup> form as:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mi>ψ</mi><mo>=</mo><mi>S</mi><mo>+</mo><mi mathvariant="script">S</mi><mi>ψ</mi><mo separator="true">,</mo><mspace width="2em"></mspace><mi>L</mi><mo>=</mo><mi mathvariant="normal">Ω</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mo>+</mo><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
L\psi = S + \mathcal{S}\psi,  
\qquad  
L=\Omega\cdot\nabla+\Sigma_t
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>q</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>4</mn><mi>π</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S=q/(4\pi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span></span></span></span></span> is the external source operator and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span></span></span></span></span> the scattering operator. Inverting <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">L</span></span></span></span></span> thus gives us:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ψ</mi><mo>=</mo><msup><mi>L</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>S</mi><mo>+</mo><msup><mi>L</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="script">S</mi><mi>ψ</mi></mrow><annotation encoding="application/x-tex">
\psi = L^{-1}S + L^{-1}\mathcal{S}\psi
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.05855em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span></span></span></span></span></span></p>
<p>which leads to the Neumann (collision-ordered) series:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ψ</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></munderover><mo stretchy="false">(</mo><msup><mi>L</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="script">S</mi><msup><mo stretchy="false">)</mo><mi>n</mi></msup><msup><mi>L</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>S</mi></mrow><annotation encoding="application/x-tex">
\psi = \sum_{n=0}^{\infty} (L^{-1}\mathcal{S})^{n} L^{-1}S
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.91851em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span></span></span></span></span></span></p>
<p>In terms of scalar flux,</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></munderover><msub><mi>ϕ</mi><mi>n</mi></msub><mo separator="true">,</mo><mspace width="2em"></mspace><msub><mi>ϕ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><msub><mi>ϕ</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">  
\phi = \sum_{n=0}^{\infty} \phi_n,  
\qquad  
\phi_{n+1} = T(\Sigma_s \phi_n),  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">ϕ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.91851em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></span></p>
<p>where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><msup><mi>L</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">T=L^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> denotes the transport-from-source operator implemented by characteristic integration and track-length tallying.</p>
<blockquote>
<p>In the implementation, we implicitly tally by quadrature over:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ϕ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi mathvariant="normal">Ω</mi></msub></munderover><msub><mi>w</mi><mi>m</mi></msub><mo separator="true">,</mo><msub><mi>ψ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><msub><mi mathvariant="normal">Ω</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi_n(\mathbf{x}) \approx \sum_{m=1}^{N_\Omega} w_m,\psi_n(\mathbf{x},\Omega_m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10675em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.83964em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.31131em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: -0.10903em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>
With <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi mathvariant="normal">Ω</mi></msub></mrow><annotation encoding="application/x-tex">N_\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> the directions parameter.</p>
</blockquote>
<h3 id="series-convergence-ratio">Series convergence ratio</h3>
<p>Each term <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\phi_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> represents particles that have undergone exactly <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span></span></span></span></span> scattering interactions prior to observation. A standard sufficient condition for convergence of the Neumann series is</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>K</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mn>1</mn><mspace width="1em"></mspace><mtext>in&nbsp;an&nbsp;appropriate&nbsp;norm</mtext><mo separator="true">,</mo><mspace width="2em"></mspace><mi>K</mi><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mi>ϕ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">  
|K| &lt; 1 \quad \text{in an appropriate norm},  
\qquad  
K(\phi)=T(\Sigma_s\phi)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">in&nbsp;an&nbsp;appropriate&nbsp;norm</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">ϕ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mclose">)</span></span></span></span></span></span></p>
<p>or, more generally, that the spectral radius <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\rho(K)&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ρ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>.</p>
<p>Physically, this implies the media is structured such that scattering does not dominate over absorption and leakage, and thus converges.</p>
<blockquote>
<p>Intuitively, this is the same as for a geometric series</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></munderover><mrow><mi>a</mi><mo>⋅</mo><mi>r</mi></mrow><mspace width="2em"></mspace><mrow><mo fence="true">{</mo><mtable rowspacing="0.3600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">∣</mi><mi>r</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>converges</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">∣</mi><mi>r</mi><mi mathvariant="normal">∣</mi><mo>≥</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>diverges</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\sum_{n=0}^\infty{a\cdot r} \qquad \begin{cases}|r| \lt 1, &amp; \text{converges} \\ |r| \ge 1, &amp; \text{diverges}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.01711em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.69em;"><span class="" style="top: -3.69em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mpunct">,</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.19em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.69em;"><span class="" style="top: -3.69em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">converges</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">diverges</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.19em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
</blockquote>
<p>In absorbing, finite media relevant to shielding and nuclear waste burial, successive scattering contributions are naturally suppressed. Each additional collision applies the combined operation</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>K</mi><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mi>ϕ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">  
K(\phi)=T(\Sigma_s\phi)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">ϕ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mclose">)</span></span></span></span></span></span></p>
<p>that is, multiplication by the scattering cross-section followed by transport with attenuation. Physically, only a fraction of particles scatters at each interaction, and those that do are further attenuated and leaked during subsequent transport.</p>
<p>In homogeneous media, this behaviour is governed by the scattering ratio</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><mfrac><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub></mfrac><mo separator="true">,</mo><mspace width="2em"></mspace><mi>c</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
c=\frac{\Sigma_s}{\Sigma_t}, \qquad c&lt;1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.19633em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></span></p>
<p>which leads to an approximate geometric decay of collision-order contributions,</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>ϕ</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><mo>≲</mo><mi>C</mi> <msup><mi>c</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">
|\phi_n| \lesssim C\,c^n 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">≲</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.714392em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span></span></span></span></span> depending on the source strength, geometry, and transient low-order effects. More generally, if the scattering ratio is uniformly bounded:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>≤</mo><msub><mi>c</mi><mi>max</mi><mo>⁡</mo></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\frac{\Sigma_s(\mathbf{r})}{\Sigma_t(\mathbf{r})} \le c_{\max}&lt;1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">r</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></span></p>
<p>then the operator <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span></span></span></span></span> is contractive in natural transport norms (or, at minimum, has spectral radius strictly less than unity), since each collision introduces an additional scattering factor while transport attenuates intensities by <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mo>∫</mo><msub><mi mathvariant="normal">Σ</mi><mi>t</mi></msub> <mi>d</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\exp(-\int \Sigma_t\,ds)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.11112em; vertical-align: -0.30612em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol small-op" style="margin-right: 0.19445em; position: relative; top: -0.00056em;">∫</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span>.</p>
<p>As a consequence, the collision-order expansion converges and higher-order terms decay beyond an initial transient. To minimize iterations <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span></span> while maintaining precision, we introduce a tolerance constant <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\epsilon \gt 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>. Convergence is assessed empirically using measured ratios:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>ϕ</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
r_n=\frac{||\phi_n||}{||\phi_{n-1}||} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mord">∣∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>When <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_n&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>, the remaining tail can be conservatively bounded iteratively over <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span></span> until:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>ϕ</mi><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>r</mi><mi>n</mi></msub></mrow></mfrac><mo>≤</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">
\frac{||\phi_{N+1}||}{1-r_n} \leq \epsilon
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.263em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mord">∣∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span></span></p>
<p>which acts as a stopping criterion for our simulation.</p>
<blockquote>
<p>Fun ends here, suffering ahead</p>
</blockquote>
<div class="page-break"></div>
<h2 id="dashboard-modernization">Dashboard modernization</h2>
<p>The dynamic dashboard of statistical interpretation has been implemented as three internal modules (<code>RunIndex</code>, <code>VolumeCache</code>, and individual view classes). It supports per-run / field overview, slices, 3D views, error plotting, performance overview, and textual access to the metadata parameters of the given run.</p>
<p><img src="http://wurwur.github.io/diss_figs/Figure_0.png" alt="dashboard lol"></p>
<div class="page-break"></div>
<h2 id="current-limitations">Current limitations</h2>
<ul>
<li>Physics scope: fixed-source photons; scattering is currently isotropic and primarily validated in homogeneous media.</li>
<li>Geometry: Cartesian voxel grid; no unstructured meshes, which forces geological media to be cut to a certain (albeit very small) voxel resolution.</li>
<li>Cross-sections: voxel-wise fields are supported. The dictionary of material cross-sections has not yet been implemented, but exists and is accessible from the background research.</li>
</ul>
<blockquote>
<p>Note: given  the cross-sections <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi mathvariant="bold">A</mi></msub><mo separator="true">,</mo><msub><mi>σ</mi><mi mathvariant="bold">B</mi></msub><mo separator="true">,</mo><mo>…</mo><msub><mi>σ</mi><mi>Z</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_\mathbf{A}, \sigma_\mathbf{B}, \dots \sigma_Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi mathvariant="bold">A</mi></msub><mo separator="true">,</mo><msub><mi>w</mi><mi mathvariant="bold">B</mi></msub><mo separator="true">,</mo><mo>…</mo><msub><mi>w</mi><mi mathvariant="bold">Z</mi></msub></mrow><annotation encoding="application/x-tex">w_\mathbf{A}, w_\mathbf{B}, \dots w_\mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> the atomic weight of elements <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi><mo separator="true">,</mo><mo>…</mo><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}, \dots \mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88055em; vertical-align: -0.19444em;"></span><span class="mord mathbf">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathbf">Z</span></span></span></span></span> of atomic number <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span></span></span></span></span>, and an element <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03785em;">δ</span></span></span></span></span> of chemical composition <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo separator="true">,</mo><mi mathvariant="bold">B</mi><mo>…</mo> <mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{A},\mathbf{B} \dots)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathbf">B</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mclose">)</span></span></span></span></span>, the cross-section of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03785em;">δ</span></span></span></span></span> is given as:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mi>δ</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi mathvariant="bold">A</mi></msub><msub><mi>Z</mi><mi mathvariant="bold">A</mi></msub><msub><mi>σ</mi><mi mathvariant="bold">A</mi></msub><mo>+</mo><msub><mi>w</mi><mi>B</mi></msub><msub><mi>Z</mi><mi>B</mi></msub><msub><mi>σ</mi><mi>B</mi></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>δ</mi></mrow></munder><mrow><msub><mi>σ</mi><mi>i</mi></msub><msub><mi>Z</mi><mi>i</mi></msub></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\Sigma_{\delta}=\frac{w_\mathbf{A}Z_\mathbf{A}\sigma_\mathbf{A}+w_BZ_B\sigma_B + ..}{\sum_{i \in \delta}{\sigma_i Z_i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03785em;">δ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.37341em; vertical-align: -1.01308em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.186398em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right: 0.03785em;">δ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">..</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.01308em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
</blockquote>
<ul>
<li>Long-term coupled processes (hydrogeology, erosion, heat transfer) are not yet implemented.</li>
</ul>
<div class="page-break"></div>
<h1 id="validation-and-benchmarking">Validation and Benchmarking</h1>
<h2 id="what-valid-means-for-this-project">What “valid” means for this project</h2>
<p>The solver is considered valid for the project goals when it is:</p>
<ul>
<li>Accurate: follows all known analytic trends (vacuum/homogeneous attenuation), and converges with angular resolution/grid refinement.</li>
<li>Predictably convergent: collision-order terms decrease at an expected rate under subcritical scattering, enabling a stopping criterion.</li>
<li>Reproducible: deterministic across repeated runs.</li>
<li>Auditable: metadata hashes, schema versioning, and stable naming allow outputs to be traced to inputs and code version.</li>
<li>Cost-effective: performance counters and NSI/LNSI<sup class="footnote-ref"><a href="#fn22" id="fnref22">22</a></sup> provide transparent scaling indicators.</li>
</ul>
<h2 id="benchmark-suite-overview">Benchmark suite overview</h2>
<p>Benchmarks are encoded as test definitions in <code>bench/tests.py</code> and run via <code>main.py</code>. Each benchmark exists to isolate a specific failure mode:</p>
<ul>
<li>
<p>Vacuum / homogeneous: checks the uncollided engine against known <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">1/r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> and exponential attenuation trends</p>
</li>
<li>
<p>Angular convergence: varies direction count to diagnose angular quadrature under-sampling</p>
</li>
<li>
<p>Scatter1 ref-vs-sweep: compares the reference voxel-emission engine to the production sweep in masked far-field regions</p>
</li>
<li>
<p>Grid refinement: checks stability of fitted far-field slopes under grid resolution changes</p>
</li>
<li>
<p>Multi-group down scatter: verifies monotone behaviour (lower energy group response bounded) in a forced down scatter-only setting</p>
</li>
<li>
<p>Determinism: hashes repeated outputs across CPU/GPU runs</p>
</li>
</ul>
<p>The suite is deliberately “atomic”: each test targets a narrow property (trend, invariance, determinism) so regressions are easy to localize. This reduces the risk of accidentally “teaching to the benchmark”, because the tests reflect structural invariants of the transport equation rather than arbitrary numeric targets.<br>
Later, we aim at implicitly benchmarking combination of those atomic features through the usage of more complex/realistic scenarios.</p>
<h2 id="results-table">Results table</h2>
<h3 id="on-gpu">On GPU</h3>
<blockquote>
<p>RTX 5070 Mobile, CUDA 13.1</p>
</blockquote>

<table>
<thead>
<tr>
<th>Test</th>
<th>Status</th>
<th align="center">Runtime (s)</th>
<th align="center">Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>vacuum_sigma0</td>
<td>PASS</td>
<td align="center">0.45</td>
<td align="center">OK</td>
</tr>
<tr>
<td>homogeneous_sigma005</td>
<td>PASS</td>
<td align="center">0.24</td>
<td align="center">OK</td>
</tr>
<tr>
<td>angular_convergence_512_to_8192</td>
<td>PASS</td>
<td align="center">0.47</td>
<td align="center">OK</td>
</tr>
<tr>
<td>scatter1_prod_sanity</td>
<td>PASS</td>
<td align="center">310.56</td>
<td align="center">OK</td>
</tr>
<tr>
<td>scatter1_ref_vs_prod_small</td>
<td>PASS</td>
<td align="center">10.70</td>
<td align="center">OK</td>
</tr>
<tr>
<td>scatter1_sigma_s_scaling</td>
<td>PASS</td>
<td align="center">134.10</td>
<td align="center">OK</td>
</tr>
<tr>
<td>scatter1_source_scaling</td>
<td>PASS</td>
<td align="center">130.12</td>
<td align="center">OK</td>
</tr>
<tr>
<td>phi1_angular_convergence</td>
<td>PASS</td>
<td align="center">272.65</td>
<td align="center">OK</td>
</tr>
<tr>
<td>phi1_grid_refinement</td>
<td>PASS</td>
<td align="center">72.74</td>
<td align="center">OK</td>
</tr>
<tr>
<td>cpu_determinism</td>
<td>PASS</td>
<td align="center">0.00</td>
<td align="center">OK</td>
</tr>
</tbody>
</table><div class="page-break"></div>
<h3 id="on-cpu">On CPU</h3>
<blockquote>
<p>Intel Ultra 9 275HX (24) @ 3.0GHz</p>
</blockquote>

<table>
<thead>
<tr>
<th align="left">Test</th>
<th>Status</th>
<th align="center">Runtime (s)</th>
<th align="center">Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">vacuum_sigma0</td>
<td>PASS</td>
<td align="center">0.21</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">homogeneous_sigma005</td>
<td>PASS</td>
<td align="center">0.17</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">angular_convergence_512_to_8192</td>
<td>PASS</td>
<td align="center">0.36</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">scatter1_prod_sanity</td>
<td>PASS</td>
<td align="center">4163.40</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">scatter1_ref_vs_prod_small</td>
<td>PASS</td>
<td align="center">80.87</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">scatter1_sigma_s_scaling</td>
<td>PASS</td>
<td align="center">1931.07</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">scatter1_source_scaling</td>
<td>PASS</td>
<td align="center">2260.28</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">phi1_angular_convergence</td>
<td>PASS</td>
<td align="center">4015.79</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">phi1_grid_refinement</td>
<td>PASS</td>
<td align="center">1040.25</td>
<td align="center">OK</td>
</tr>
<tr>
<td align="left">cpu_determinism</td>
<td>PASS</td>
<td align="center">0.01</td>
<td align="center">OK</td>
</tr>
</tbody>
</table><div class="page-break"></div>
<h1 id="planned-work">Planned Work</h1>
<h2 id="prioritized-deliverables">Prioritized deliverables</h2>
<p><strong>Must have</strong></p>
<ul>
<li>
<p>Extend collision-order engine to compute <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\phi_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> and output compact packed binaries.</p>
</li>
<li>
<p>Implement automatic selection of the minimum <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span></span> such that <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>ϕ</mi><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><msub><mi>ϕ</mi><mi>k</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\phi - \sum_{k=0}^{N} \phi_k|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">ϕ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 3.13045em; vertical-align: -1.30211em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30211em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></span> meets a tolerance, using internal tail bounds and (where available) truth ingestion.</p>
</li>
</ul>
<blockquote>
<p>We have already done the math, but the implementation only computes <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\phi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>h</mi><msub><mi>i</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> currently, the latter being hard-coded for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\psi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
</blockquote>
<ul>
<li>Build the geology ingestion pipeline:
<ul>
<li>parse BGS datasets into a voxel material map,</li>
<li>build cross-section tables per material per energy group (from literature databases),</li>
<li>validate dataset consistency (boreholes, faults/dykes, seismic/volcanic regions).</li>
</ul>
</li>
</ul>
<p><strong>Should have</strong></p>
<ul>
<li>
<p>Expand validation with harder benchmarks and comparisons against known sites and datasets (OECD/NEA packages, CASL VERA-style benchmarks where relevant to shielding, and external datasets such as West et al.)<sup class="footnote-ref"><a href="#fn16" id="fnref16:1">16</a></sup>.</p>
</li>
<li>
<p>Export/import of runs to avoid recomputation and to support reproducible scenario sharing.</p>
</li>
<li>
<p>Produce a web app that allows the user to select a UK location, bounding box, and simulation parameters, run the solver, and view results in a dashboard with appropriate uncertainty/accuracy context.</p>
</li>
</ul>
<p><strong>Could have</strong></p>
<ul>
<li>
<p>Time evolution: erosion, hydrogeology, heat transfer coupling (data permitting, Darcy-type flow relevance), and scenario ensembles.<sup class="footnote-ref"><a href="#fn15" id="fnref15:1">15</a></sup></p>
</li>
<li>
<p>Advanced visualization pipelines (Plotly / PlotJuggler<sup class="footnote-ref"><a href="#fn23" id="fnref23">23</a></sup>) for interactive web dashboards.</p>
</li>
</ul>
<p><strong>Won’t have (for this project timeframe)</strong></p>
<ul>
<li>Full coupled multi-physics with validated long-term climate models; the focus is radiation transport + integration-ready geology representation.</li>
</ul>
<blockquote>
<p>I’d make the point that if climate change was to vary enough in the future that the entire scenario shifts drastically, we’d all be dead anyways.</p>
</blockquote>
<h2 id="risks-and-mitigation">Risks and mitigation</h2>
<p>Because of the remaining uncertainty of BGS licensing, we maintain synthetic geology pipelines and placeholders currently implemented, ready to swap to real data when available. If never available, the project is built to support a diversion of requirements to maintain a working auditable and provable ray-tracing engine without the explicit support / implementation of “realistic” geological media. #TooBad</p>
<div class="page-break"></div>
<h1 id="example-run">Example Run</h1>
<h3 id="test-run-phi1_grid_fine">Test run: <code>phi1_grid_fine</code></h3>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Paremeters</mtext><mo>:</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.1600em" columnalign="left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>grid</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>128</mn><mo>×</mo><mn>128</mn><mo>×</mo><mn>128</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>h</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>dirs</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2048</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>σ</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.05</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>σ</mi><mi>s</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.03</mn></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{Paremeters} :
\begin{cases}
\begin{array}{lll}
\text{grid} &amp;=&amp; 128\times128\times128 \\
\text{h}&amp;=&amp;1 \\
\text{dirs}&amp;=&amp;2048 \\
\sigma_t&amp;=&amp;0.05 \\
\sigma_s&amp;=&amp;0.03
\end{array}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">Paremeters</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 6.00004em; vertical-align: -2.75002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25002em;"><span class="" style="top: -1.36599em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -1.35799em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="height: 1.216em; width: 0.889em;"><svg width="0.889em" height="1.2160000000000002em" style="width:0.889em" viewBox="0 0 889 1216" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V1216 H384z M384 0 H504 V1216 H384z"></path></svg></span></span><span class="" style="top: -3.21601em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.35801em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="height: 1.216em; width: 0.889em;"><svg width="0.889em" height="1.2160000000000002em" style="width:0.889em" viewBox="0 0 889 1216" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V1216 H384z M384 0 H504 V1216 H384z"></path></svg></span></span><span class="" style="top: -5.56602em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em;"><span class="" style="top: -5.25em;"><span class="pstrut" style="height: 5.25em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em;"><span class="" style="top: -5.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">grid</span></span></span></span><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">h</span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">dirs</span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -0.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em;"><span class="" style="top: -5.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mrel">=</span></span></span><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mrel">=</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mrel">=</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mrel">=</span></span></span><span class="" style="top: -0.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em;"><span class="" style="top: -5.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">128</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">128</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">128</span></span></span><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2048</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0.05</span></span></span><span class="" style="top: -0.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0.03</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<blockquote>
<p>Full run metadata: see Appendix: Run Metadata</p>
</blockquote>
<p><img src="http://wurwur.github.io/diss_figs/Figure_2.png" alt="enter image description here"></p>
<p><strong>Figure 1.</strong> <em>Distance Weighted Overview over run “<code>phi1_grid_fine</code>”. [Unpublished]. University of Warwick.</em></p>
<blockquote>
<p>Bottom layer displays the mean radiation per vertical slice of voxel<br>
Top layer attributes displays the mean radiation factored by distance to origin per vertical slice of voxel (the furtherst from radiation source, the more meaningful the radiation)</p>
</blockquote>
<p><img src="http://wurwur.github.io/diss_figs/Figure_3.png" alt="enter image description here"></p>
<p><strong>Figure 2.</strong> <em>Dynamic Orthogonal Slice Planes over run “<code>phi1_grid_fine</code>”. [Unpublished]. University of Warwick.</em></p>
<p><img src="http://wurwur.github.io/diss_figs/Figure_4.png" alt="enter image description here"></p>
<p><strong>Figure 3.</strong> <em>Static Single-Axis Layered View over run “<code>phi1_grid_fine</code>”. [Unpublished]. University of Warwick.</em></p>
<p><img src="http://wurwur.github.io/diss_figs/Figure_5.png" alt="enter image description here"></p>
<p><strong>Figure 4.</strong> <em>Iso cloud Graph of Density per Intensity over run “<code>phi1_grid_fine</code>”. [Unpublished]. University of Warwick.</em></p>
<blockquote>
<p>Pretty ay? I know<br>
Runtime is in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">s</span></span></span></span></span>.</p>
</blockquote>
<h1 id="appraisal-and-reflection">Appraisal and Reflection</h1>
<p>I really love rocks and irradiation. No further reflections regarding how to optimize workflow or throughput, everything is going smoothly and according to plan.</p>
<h1 id="legal-social-ethical-and-professional-considerations">Legal, Social, Ethical, and Professional Considerations</h1>
<p>There are no human-subject consent or ethical issues. The primary legal/professional consideration is the licensing of BGS data and ensuring that redistribution and derived products respect the terms of use.</p>
<h1 id="project-management-approach">Project Management Approach</h1>
<p>A waterfall approach is used deliberately: each milestone is intended to be a self-contained valid deliverable that remains valuable even if downstream data integration is delayed, and benchmark suite is strictly incremental across iterations. Version control is managed with git; milestones are captured with tags and supported by reproducible benchmark runs. Supervisor input (Hi Claire :) ) has guided prioritization and helped keep the scope realistic (mostly by asking me over and over “but how will you prove it”).</p>
<div class="page-appendix-start"></div>
<h2 id="updated-gantt-chart">Updated Gantt Chart</h2>
<p><img src="https://wurwur.github.io/timeline.png" alt="timeline"></p>
<blockquote>
<p>The above Gantt Chart does not implement changes described in the updated specification and requirements.</p>
</blockquote>
<h2 id="benchmark-results-table">Benchmark results table</h2>
<h3 id="tests">Tests</h3>

<table>
<thead>
<tr>
<th>Test</th>
<th align="center">Status</th>
<th align="center">Runtime (s)</th>
<th align="center">Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vacuum_sigma0</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">0.45</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>homogeneous_sigma005</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">0.24</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>angular_convergence_512_to_8192</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">0.47</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>phi0_convergence_sweep</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">0.72</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>scatter1_prod_sanity</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">310.56</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>scatter1_ref_vs_prod_small</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">10.70</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>scatter1_sigma_s_scaling</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">134.10</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>scatter1_source_scaling</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">130.12</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>phi1_angular_convergence</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">272.65</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>phi1_grid_refinement</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">72.74</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>multigroup_downscatter</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">6.44</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>gpu_determinism</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">0.45</td>
<td align="center">OK</td>
</tr>
<tr>
<td><code>cpu_determinism</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="yellowgreen"><mtext>PASS</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{yellowgreen}\text{PASS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text" style="color: yellowgreen;"><span class="mord" style="color: yellowgreen;">PASS</span></span></span></span></span></span></td>
<td align="center">0.00</td>
<td align="center">OK</td>
</tr>
</tbody>
</table><h3 id="runs">Runs</h3>

<table>
<thead>
<tr>
<th>Run</th>
<th align="center">Cached</th>
<th align="center">Warn</th>
<th align="center">Runtime (s)</th>
<th align="center">NSI (ns/seg)</th>
<th align="center">LNSI (ns/seg)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vacuum_sigma0</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.45</td>
<td align="center">9.452e+02</td>
<td align="center">3.939e+01</td>
</tr>
<tr>
<td><code>homogeneous_sigma</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.24</td>
<td align="center">9.879e+02</td>
<td align="center">4.116e+01</td>
</tr>
<tr>
<td><code>angconv_small</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.22</td>
<td align="center">3.706e+03</td>
<td align="center">1.544e+02</td>
</tr>
<tr>
<td><code>angconv_large</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.25</td>
<td align="center">2.610e+02</td>
<td align="center">1.087e+01</td>
</tr>
<tr>
<td><code>phi0_convergence_dirs_512</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.23</td>
<td align="center">3.900e+03</td>
<td align="center">1.625e+02</td>
</tr>
<tr>
<td><code>phi0_convergence_dirs_2048</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.25</td>
<td align="center">1.057e+03</td>
<td align="center">4.405e+01</td>
</tr>
<tr>
<td><code>phi0_convergence_dirs_8192</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.23</td>
<td align="center">2.438e+02</td>
<td align="center">1.016e+01</td>
</tr>
<tr>
<td><code>scatter1_ref</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">244.35</td>
<td align="center">5.731e+00</td>
<td align="center">2.388e-01</td>
</tr>
<tr>
<td><code>scatter1_prod</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">66.20</td>
<td align="center">5.789e+00</td>
<td align="center">2.412e-01</td>
</tr>
<tr>
<td><code>scatter1_ref_small</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">5.57</td>
<td align="center">8.319e+00</td>
<td align="center">3.466e-01</td>
</tr>
<tr>
<td><code>scatter1_prod_small</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">5.13</td>
<td align="center">1.448e+01</td>
<td align="center">6.032e-01</td>
</tr>
<tr>
<td><code>scatter1_sigma_s_low</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">69.86</td>
<td align="center">6.108e+00</td>
<td align="center">2.545e-01</td>
</tr>
<tr>
<td><code>scatter1_sigma_s_high</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">64.25</td>
<td align="center">5.618e+00</td>
<td align="center">2.341e-01</td>
</tr>
<tr>
<td><code>scatter1_source_low</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">65.66</td>
<td align="center">5.741e+00</td>
<td align="center">2.392e-01</td>
</tr>
<tr>
<td><code>scatter1_source_high</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">64.47</td>
<td align="center">5.637e+00</td>
<td align="center">2.349e-01</td>
</tr>
<tr>
<td><code>phi1_angconv_small</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">17.36</td>
<td align="center">6.072e+00</td>
<td align="center">2.530e-01</td>
</tr>
<tr>
<td><code>phi1_angconv_large</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">255.29</td>
<td align="center">5.580e+00</td>
<td align="center">2.325e-01</td>
</tr>
<tr>
<td><code>phi1_grid_coarse</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">9.09</td>
<td align="center">6.404e+00</td>
<td align="center">2.668e-01</td>
</tr>
<tr>
<td><code>phi1_grid_fine</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">63.65</td>
<td align="center">5.565e+00</td>
<td align="center">2.319e-01</td>
</tr>
<tr>
<td><code>multigroup_downscatter</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">6.44</td>
<td align="center">4.811e+00</td>
<td align="center">2.004e-01</td>
</tr>
<tr>
<td><code>gpu_determinism_a</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.24</td>
<td align="center">2.652e+05</td>
<td align="center">1.105e+04</td>
</tr>
<tr>
<td><code>gpu_determinism_b</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.21</td>
<td align="center">2.364e+05</td>
<td align="center">9.852e+03</td>
</tr>
<tr>
<td><code>cpu_determinism_omp1_a</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.00</td>
<td align="center">1.520e+02</td>
<td align="center">1.520e+02</td>
</tr>
<tr>
<td><code>cpu_determinism_omp1_b</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.00</td>
<td align="center">1.791e+02</td>
<td align="center">1.791e+02</td>
</tr>
<tr>
<td><code>cpu_determinism_omp2</code></td>
<td align="center"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mtext>yes</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{cyan}\text{yes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord text" style="color: cyan;"><span class="mord" style="color: cyan;">yes</span></span></span></span></span></span></td>
<td align="center"></td>
<td align="center">0.00</td>
<td align="center">3.550e+02</td>
<td align="center">1.775e+02</td>
</tr>
</tbody>
</table><h2 id="run-metadata">Run Metadata</h2>
<pre class=" language-json"><code class="prism  language-json"><span class="token punctuation">{</span>
  <span class="token string">"bench"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"bench_hash"</span><span class="token punctuation">:</span> <span class="token string">"dc0552bfacba01d223e257d6ba74ed2aecaca3465d979968a3a0950f068aa50e"</span><span class="token punctuation">,</span>
    <span class="token string">"config"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">"device"</span><span class="token punctuation">:</span> <span class="token string">"gpu"</span><span class="token punctuation">,</span>
      <span class="token string">"dirs"</span><span class="token punctuation">:</span> <span class="token number">2048</span><span class="token punctuation">,</span>
      <span class="token string">"env"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token string">"groups"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token string">"h"</span><span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
      <span class="token string">"k_slice"</span><span class="token punctuation">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
      <span class="token string">"meta_path"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__meta.json"</span><span class="token punctuation">,</span>
      <span class="token string">"mode"</span><span class="token punctuation">:</span> <span class="token string">"scatter1_sweep"</span><span class="token punctuation">,</span>
      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"phi1_grid_fine"</span><span class="token punctuation">,</span>
      <span class="token string">"nx"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
      <span class="token string">"ny"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
      <span class="token string">"nz"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
      <span class="token string">"out_csv"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0.csv"</span><span class="token punctuation">,</span>
      <span class="token string">"out_phi0_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0_3d.bin"</span><span class="token punctuation">,</span>
      <span class="token string">"out_phi1"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1.csv"</span><span class="token punctuation">,</span>
      <span class="token string">"out_phi1_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1_3d.bin"</span><span class="token punctuation">,</span>
      <span class="token string">"out_q1_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__q1_3d.bin"</span><span class="token punctuation">,</span>
      <span class="token string">"run_dir"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest"</span><span class="token punctuation">,</span>
      <span class="token string">"sigma_s"</span><span class="token punctuation">:</span> <span class="token number">0.03</span><span class="token punctuation">,</span>
      <span class="token string">"sigma_s_down"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token string">"sigma_s_groups"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token string">"sigma_t"</span><span class="token punctuation">:</span> <span class="token number">0.05</span><span class="token punctuation">,</span>
      <span class="token string">"sigma_t_groups"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token string">"src_center"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token number">64.0</span><span class="token punctuation">,</span>
        <span class="token number">64.0</span><span class="token punctuation">,</span>
        <span class="token number">64.0</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">"src_halfsize"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token number">0.5</span><span class="token punctuation">,</span>
        <span class="token number">0.5</span><span class="token punctuation">,</span>
        <span class="token number">0.5</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">"src_strength"</span><span class="token punctuation">:</span> <span class="token number">1.0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"phi1_grid_fine"</span><span class="token punctuation">,</span>
    <span class="token string">"outputs"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">"phi0"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0.csv"</span><span class="token punctuation">,</span>
      <span class="token string">"phi0_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0_3d.bin"</span><span class="token punctuation">,</span>
      <span class="token string">"phi1"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1.csv"</span><span class="token punctuation">,</span>
      <span class="token string">"phi1_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1_3d.bin"</span><span class="token punctuation">,</span>
      <span class="token string">"q1_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__q1_3d.bin"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"rt_hash"</span><span class="token punctuation">:</span> <span class="token string">"8de286f5e8e7eba26430e7c840e594c0e8d5682240155eb083c07f72fffd0564"</span><span class="token punctuation">,</span>
    <span class="token string">"run_dir"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"bench_runtime_s"</span><span class="token punctuation">:</span> <span class="token number">65.52425886101264</span><span class="token punctuation">,</span>
  <span class="token string">"config"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"device"</span><span class="token punctuation">:</span> <span class="token string">"gpu"</span><span class="token punctuation">,</span>
    <span class="token string">"dirs"</span><span class="token punctuation">:</span> <span class="token number">2048</span><span class="token punctuation">,</span>
    <span class="token string">"h"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">"k_slice"</span><span class="token punctuation">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
    <span class="token string">"mode"</span><span class="token punctuation">:</span> <span class="token string">"scatter1_sweep"</span><span class="token punctuation">,</span>
    <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"phi1_grid_fine"</span><span class="token punctuation">,</span>
    <span class="token string">"nx"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
    <span class="token string">"ny"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
    <span class="token string">"nz"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
    <span class="token string">"scatter_mode"</span><span class="token punctuation">:</span> <span class="token string">"ref"</span><span class="token punctuation">,</span>
    <span class="token string">"sigma_s"</span><span class="token punctuation">:</span> <span class="token number">0.03</span><span class="token punctuation">,</span>
    <span class="token string">"sigma_t"</span><span class="token punctuation">:</span> <span class="token number">0.05</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"config_hash"</span><span class="token punctuation">:</span> <span class="token string">"afebd1af67be203e61cc47b94b184c3d86e4533795baf28210c2ded25f45c067"</span><span class="token punctuation">,</span>
  <span class="token string">"device"</span><span class="token punctuation">:</span> <span class="token string">"gpu"</span><span class="token punctuation">,</span>
  <span class="token string">"dirs"</span><span class="token punctuation">:</span> <span class="token number">2048</span><span class="token punctuation">,</span>
  <span class="token string">"gpu_emulated"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">"grid"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"nx"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
    <span class="token string">"ny"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
    <span class="token string">"nz"</span><span class="token punctuation">:</span> <span class="token number">128</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"k_slice"</span><span class="token punctuation">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
  <span class="token string">"lnsi_seg"</span><span class="token punctuation">:</span> <span class="token number">0.2318951088</span><span class="token punctuation">,</span>
  <span class="token string">"mode"</span><span class="token punctuation">:</span> <span class="token string">"scatter1_sweep"</span><span class="token punctuation">,</span>
  <span class="token string">"n_threads"</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"phi1_grid_fine"</span><span class="token punctuation">,</span>
  <span class="token string">"nsi_seg"</span><span class="token punctuation">:</span> <span class="token number">5.565482611</span><span class="token punctuation">,</span>
  <span class="token string">"outputs"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"phi0"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0.csv"</span><span class="token punctuation">,</span>
    <span class="token string">"phi0_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0_3d.bin"</span><span class="token punctuation">,</span>
    <span class="token string">"phi0_bin"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0_3d.bin"</span><span class="token punctuation">,</span>
    <span class="token string">"phi0_csv"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi0.csv"</span><span class="token punctuation">,</span>
    <span class="token string">"phi1"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1.csv"</span><span class="token punctuation">,</span>
    <span class="token string">"phi1_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1_3d.bin"</span><span class="token punctuation">,</span>
    <span class="token string">"phi1_bin"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1_3d.bin"</span><span class="token punctuation">,</span>
    <span class="token string">"phi1_csv"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__phi1.csv"</span><span class="token punctuation">,</span>
    <span class="token string">"q1_3d"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__q1_3d.bin"</span><span class="token punctuation">,</span>
    <span class="token string">"q1_bin"</span><span class="token punctuation">:</span> <span class="token string">"runs/latest/phi1_grid_fine__grid128x128x128__dirs2048__sigmaT0.05__sigmaS0.03__q1_3d.bin"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"quad"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"weight_max"</span><span class="token punctuation">:</span> <span class="token number">0.006135923152</span><span class="token punctuation">,</span>
    <span class="token string">"weight_min"</span><span class="token punctuation">:</span> <span class="token number">0.006135923152</span><span class="token punctuation">,</span>
    <span class="token string">"weight_sum"</span><span class="token punctuation">:</span> <span class="token number">12.56637061</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"runtime_s"</span><span class="token punctuation">:</span> <span class="token number">63.65110004</span><span class="token punctuation">,</span>
  <span class="token string">"scatter_mode"</span><span class="token punctuation">:</span> <span class="token string">"ref"</span><span class="token punctuation">,</span>
  <span class="token string">"sigma_s"</span><span class="token punctuation">:</span> <span class="token number">0.03</span><span class="token punctuation">,</span>
  <span class="token string">"sigma_t"</span><span class="token punctuation">:</span> <span class="token number">0.05</span><span class="token punctuation">,</span>
  <span class="token string">"total_rays"</span><span class="token punctuation">:</span> <span class="token number">99864831</span><span class="token punctuation">,</span>
  <span class="token string">"total_segments"</span><span class="token punctuation">:</span> <span class="token number">11436762000</span><span class="token punctuation">,</span>
  <span class="token string">"transport_time_ns"</span><span class="token punctuation">:</span> <span class="token number">63651100040.0</span>
</code></pre>
<h2 id="project-specifications">Project Specifications</h2>
<div class="page-appendix-end"></div>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Lennemann, Wm.L., Parker, H.E. and West, P.J. (1976). Management of radioactive wastes. <em>Annals of Nuclear Energy</em>, [online] 3(5-6), pp.285–295. doi:<a href="https://doi.org/10.1016/0306-4549(76)90055-4">https://doi.org/10.1016/0306-4549(76)90055-4</a>. <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p>Lennemann, Wm.L., Parker, H.E. and West, P.J. (1976). Management of radioactive wastes. <em>Annals of Nuclear Energy</em>, [online] 3(5-6), pp.285–295. doi:<a href="https://doi.org/10.1016/0306-4549(76)90055-4">https://doi.org/10.1016/0306-4549(76)90055-4</a>. <a href="#fnref2" class="footnote-backref">↩︎</a> <a href="#fnref2:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p>European Union (EUR-Lex) (2021). <em>Nuclear facilities and radioactive waste — EU decommissioning assistance (2021-2027) | EUR-Lex</em>. [online] <a href="http://Europa.eu">Europa.eu</a>. Available at: <a href="https://eur-lex.europa.eu/EN/legal-content/summary/nuclear-facilities-and-radioactive-waste-eu-decommissioning-assistance-2021-2027.html">https://eur-lex.europa.eu/EN/legal-content/summary/nuclear-facilities-and-radioactive-waste-eu-decommissioning-assistance-2021-2027.html</a> [Accessed 22 Jan. 2026]. <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn4" class="footnote-item"><p>Institute for Energy Economics and Financial Analysis (2026). <em>EU risks new energy dependence as US could supply 80% of its LNG imports by 2030</em>. [online] <a href="http://Ieefa.org">Ieefa.org</a>. Available at: <a href="https://ieefa.org/resources/eu-risks-new-energy-dependence-us-could-supply-80-its-lng-imports-2030">https://ieefa.org/resources/eu-risks-new-energy-dependence-us-could-supply-80-its-lng-imports-2030</a>. <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn5" class="footnote-item"><p>J. A. Kulesza, T. R. Adams, J. C. Armstrong, S. R. Bolding, F. B. Brown, J. S. Bull, T. P. Burke, A. R. Clark, R. A. Forster III, J. F. Giron, A. S. Grieve, C. J. Josey, R. L. Martz, G. W. McKinney, E. J. Pearson, M. E. Rising, C. J. Solomon Jr., S. Swaminarayan, T. J. Trahan, C. A. Weaver, S. C. Wilson, A. J. Zukaitis. <strong>MCNP®  Code Version 6.3.1 Theory &amp; User Manual</strong>. Los Alamos National Laboratory Tech. Rep. LA-UR-24-24602, Rev. 1. Los Alamos, NM, USA. May 2024. <a href="#fnref5" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn6" class="footnote-item"><p>K. Ogawa and S. Maeda, “A Monte Carlo method using octree structure in photon and electron transport,” in IEEE Transactions on Nuclear Science, vol. 42, no. 6, pp. 2322-2326, Dec. 1995, doi: 10.1109/23.489435. <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn7" class="footnote-item"><p>Wang A, Maslowski A, Wareing T, Star-Lack J, Schmidt TG. A fast, linear Boltzmann transport equation solver for computed tomography dose calculation (Acuros CTD). Med Phys. 2019 Feb;46(2):925-933. doi: 10.1002/mp.13305. Epub 2018 Dec 24. PMID: 30471131; PMCID: PMC6367051. <a href="#fnref7" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn8" class="footnote-item"><p>Tramm, J.R., Smith, K.S., Forget, B. and Siegel, A.R. (2017). The Random Ray Method for neutral particle transport. <em>Journal of Computational Physics</em>, [online] 342, pp.229–252. doi:<a href="https://doi.org/10.1016/j.jcp.2017.04.038">https://doi.org/10.1016/j.jcp.2017.04.038</a>. <a href="#fnref8" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn9" class="footnote-item"><p>Cahn, R.N. (2000). Cross-section formulae for specific processes. <em>The European Physical Journal C</em>, [online] 15(1-4), pp.215–217. doi:<a href="https://doi.org/10.1007/bf02683431">https://doi.org/10.1007/bf02683431</a>. <a href="#fnref9" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a href="mailto:curtis.suplee@nist.gov">curtis.suplee@nist.gov</a> (2009). <em>XCOM: Photon Cross Sections Database</em>. [online] NIST. Available at: <a href="https://www.nist.gov/pml/xcom-photon-cross-sections-database">https://www.nist.gov/pml/xcom-photon-cross-sections-database</a>. <a href="#fnref10" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn11" class="footnote-item"><p>IAEA Safety Standards for protecting people and the environment Disposal of Radioactive Waste. (2007). Available at: <a href="https://www-pub.iaea.org/MTCD/Publications/PDF/Pub1449_web.pdf">https://www-pub.iaea.org/MTCD/Publications/PDF/Pub1449_web.pdf</a>. <a href="#fnref11" class="footnote-backref">↩︎</a> <a href="#fnref11:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn12" class="footnote-item"><p>alliepiper (2022). <em>Address issues with existing determinism guarantees</em>. [online] GitHub. Available at: <a href="https://github.com/NVIDIA/cccl/issues/886">https://github.com/NVIDIA/cccl/issues/886</a> [Accessed 22 Jan. 2026]. <a href="#fnref12" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ANDRA (Agence Nationale pour la gestion des déchets radioactifs) (2022). <em>Dossier D’autorisation De création De l’installation nucléaire De base (inb) cigéo Version préliminaire du rapport de sûreté Partie ii</em>. [online] Available at: <a href="https://www.andra.fr/sites/default/files/2023-04/Pi%C3%A8ce%2007-VPRS-PARTIE%202%20Description-Volume%2004-Site%20et%20environnement.pdf">https://www.andra.fr/sites/default/files/2023-04/Pièce 07-VPRS-PARTIE 2 Description-Volume 04-Site et environnement.pdf</a> [Accessed 22 Jan. 2026]. <a href="#fnref13" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn14" class="footnote-item"><p>IRSN (Institut de radioprotection et de sûreté nucléaire) (2011). <em>Identifier et prévenir les risques liés au stockage géologique de déchets nucléaires Faire avancer la sûreté nucléaire</em>. [online] Available at: <a href="https://recherche-expertise.asnr.fr/sites/default/files/documents/actualites_presse/actualites/IRSN_plaquette_tournemire.pdf">https://recherche-expertise.asnr.fr/sites/default/files/documents/actualites_presse/actualites/IRSN_plaquette_tournemire.pdf</a> [Accessed 22 Jan. 2026]. <a href="#fnref14" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn15" class="footnote-item"><p>Grambow, B., Landesman, C. and Ribet, S. (2014). Nuclear waste disposal: I. Laboratory simulation of repository properties. <em>Applied Geochemistry</em>, 49, pp.237–246. doi:<a href="https://doi.org/10.1016/j.apgeochem.2014.05.017">https://doi.org/10.1016/j.apgeochem.2014.05.017</a>. <a href="#fnref15" class="footnote-backref">↩︎</a> <a href="#fnref15:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn16" class="footnote-item"><p><a href="http://Oecd-nea.org">Oecd-nea.org</a>. (2022). <em>ISOSHLD, Decay Gamma Dose, Bremsstrahlung Dose Behind Shield, Fission Products Source Strength</em>. [online] Available at: <a href="https://www.oecd-nea.org/tools/abstract/detail/ccc-0079/">https://www.oecd-nea.org/tools/abstract/detail/ccc-0079/</a> [Accessed 22 Jan. 2026]. OECD/NEA benchmark packages. <a href="#fnref16" class="footnote-backref">↩︎</a> <a href="#fnref16:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn17" class="footnote-item"><p>OpenGATE (2025). <em>opengate/opengate/tests/src at master · OpenGATE/opengate</em>. [online] GitHub. Available at: <a href="https://github.com/OpenGATE/opengate/tree/master/opengate/tests/src">https://github.com/OpenGATE/opengate/tree/master/opengate/tests/src</a> [Accessed 22 Jan. 2026]. Open-source test suites and validation references. <a href="#fnref17" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn18" class="footnote-item"><p>Amanatides, John &amp; Woo, Andrew. (1987). A Fast Voxel Traversal Algorithm for Ray Tracing. Proceedings of EuroGraphics. 87. <a href="#fnref18" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn19" class="footnote-item"><p>Mosorov, V. (2017). The Lambert-Beer law in time domain form and its application. <em>Applied Radiation and Isotopes</em>, 128, pp.1–5. doi:<a href="https://doi.org/10.1016/j.apradiso.2017.06.039">https://doi.org/10.1016/j.apradiso.2017.06.039</a>. <a href="#fnref19" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn20" class="footnote-item"><p><a href="http://Openmc.org">Openmc.org</a>. (2025). <em>5. Neutron Physics — OpenMC Documentation</em>. [online] Available at: <a href="https://docs.openmc.org/en/stable/methods/neutron_physics.html">https://docs.openmc.org/en/stable/methods/neutron_physics.html</a>. <a href="#fnref20" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn21" class="footnote-item"><p>Harbour, L., Ragusa, J., Wang, Y., Schunert, S., Gaston, D. and Dehart, M. (2019). <em>Uncollided-Flux Treatment for Discrete- Ordinate Radiation Transport Solutions in the Rattlesnake Code System</em>. [online] Available at: <a href="https://inldigitallibrary.inl.gov/sites/sti/sti/Sort_18769.pdf">https://inldigitallibrary.inl.gov/sites/sti/sti/Sort_18769.pdf</a> [Accessed 22 Jan. 2026]. <a href="#fnref21" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn22" class="footnote-item"><p>Gaston, D.R., Forget, B., Smith, K.S., Harbour, L.H., Ridley, G.K. and Giudicelli, G.G. (2021). Method of Characteristics for 3D, Full-Core Neutron Transport on Unstructured Mesh. <em>Nuclear Technology</em>, 207(7), pp.931–953. doi:<a href="https://doi.org/10.1080/00295450.2021.1871995">https://doi.org/10.1080/00295450.2021.1871995</a>. <a href="#fnref22" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn23" class="footnote-item"><p>Faconti, D. (2026). <em>PlotJuggler Fast, intuitive and extensible time series visualization tool.</em> [online] <a href="http://Plotjuggler.io">Plotjuggler.io</a>. Available at: <a href="https://plotjuggler.io/">https://plotjuggler.io/</a> [Accessed 22 Jan. 2026]. <a href="#fnref23" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>

        </div>
      </div>
      <script>
      (function () {
      const WRAP_COL = 85;
      function normalizePrismLanguageClass(codeEl) {
      if (!codeEl || !codeEl.classList) return;
      if (codeEl.classList.contains("language-py")) {
      codeEl.classList.remove("language-py");
      codeEl.classList.add("language-python");
      }
      if (codeEl.classList.contains("language-yml")) {
      codeEl.classList.remove("language-yml");
      codeEl.classList.add("language-yaml");
      }
      if (codeEl.classList.contains("language-sh")) {
      codeEl.classList.remove("language-sh");
      codeEl.classList.add("language-bash");
      }
      }^\s*#
      function isCommentLine(line) {
      let inSingle = false;
      let inDouble = false;
      for (let i = 0; i < line.length; i++) {
      const c = line[i];
      const prev = i > 0 ? line[i - 1] : "";
      if (c === "'" && !inDouble && prev !== "\\") {
      inSingle = !inSingle;
      continue;
      }
      if (c === '"' && !inSingle && prev !== "\\") {
      inDouble = !inDouble;
      continue;
      }
      if (c === "#" && !inSingle && !inDouble) {
      return true;
      }
      }
      return false;
      }
      function wrapOneLine(line, width) {
      if (line.length <= width) return [line];
      const isComment = isCommentLine(line);
      const commentPrefix = isComment ? "# " : "";
      const out = [];
      let i = 0;
      let first = true;
      while (i < line.length) {
      let limit = width;
      if (!first && isComment) {
      limit = Math.max(10, width - commentPrefix.length);
      }
      const chunk = line.slice(i, i + limit);
      if (first) {
      out.push(chunk);
      } else if (isComment) {
      out.push(commentPrefix + chunk);
      } else {
      out.push(chunk);
      }
      i += chunk.length;
      first = false;
      }
      return out;
      }
      function wrapCodeText(text, width) {
      const lines = text.replace(/\r\n/g, "\n").split("\n");
      const wrapped = [];
      for (const line of lines) {
      const parts = wrapOneLine(line, width);
      for (const p of parts) wrapped.push(p);
      }
      return wrapped.join("\n");
      }
      function prismHighlight(codeEl) {
      if (!window.Prism || typeof window.Prism.highlightElement !== "function") return;
      normalizePrismLanguageClass(codeEl);
      window.Prism.highlightElement(codeEl);
      }
      function beforePrint() {
      const codeBlocks = document.querySelectorAll("pre code");
      for (const code of codeBlocks) {
      if (!code.dataset.originalHtml) code.dataset.originalHtml = code.innerHTML;
      const originalText = code.textContent || "";
      const wrappedText = wrapCodeText(originalText, WRAP_COL);
      code.textContent = wrappedText;
      prismHighlight(code);
      }
      }
      function afterPrint() {
      const codeBlocks = document.querySelectorAll("pre code");
      for (const code of codeBlocks) {
      if (code.dataset.originalHtml) {
      code.innerHTML = code.dataset.originalHtml;
      delete code.dataset.originalHtml;
      }
      }
      }
      window.addEventListener("beforeprint", beforePrint);
      window.addEventListener("afterprint", afterPrint);
      const mql = window.matchMedia("print");
      if (mql && typeof mql.addEventListener === "function") {
      mql.addEventListener("change", (e) => {
      if (e.matches) beforePrint();
      else afterPrint();
      });
      }
      })();
      </script>
      <script>
      (function () {
      function makeTocLi(href, text) {
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = href;
      a.textContent = text;
      li.appendChild(a);
      return li;
      }
      function ensureNestedUl(li) {
      let ul = li.querySelector(":scope > ul");
      if (!ul) {
      ul = document.createElement("ul");
      li.appendChild(ul);
      }
      return ul;
      }
      function findLeftTocContainer() {
      return document.querySelector(".stackedit__left .stackedit__toc");
      }
      function findLeftTocRootUl() {
      const c = findLeftTocContainer();
      return c ? c.querySelector(":scope > ul") : null;
      }
      function findTopLi(rootUl) {
      return rootUl ? rootUl.querySelector(":scope > li") : null;
      }
      function buildH1(id, text) {
      const h = document.createElement("h1");
      h.id = id;
      h.textContent = text;
      return h;
      }
      function ensureReferencesHeadingFromFootnotes() {
      const hr = document.querySelector("hr.footnotes-sep");
      if (!hr) return false;
      const h = buildH1("references", "References");
      hr.parentNode.replaceChild(h, hr);
      return true;
      }
      function moveAppendixRangeToEnd() {
      const root = document.querySelector(".stackedit__html");
      if (!root) return null;
      const start = root.querySelector(".page-appendix-start");
      const end = root.querySelector(".page-appendix-end");
      if (!start || !end) return null;
      const frag = document.createDocumentFragment();
      let node = start.nextSibling;
      while (node && node !== end) {
      const next = node.nextSibling;
      frag.appendChild(node);
      node = next;
      }
      start.remove();
      end.remove();
      const pb = document.createElement("div");
      pb.className = "page-break";
      const h1 = buildH1("appendix", "Appendix");
      const wrapper = document.createElement("div");
      wrapper.className = "page-appendix";
      wrapper.appendChild(frag);
      root.appendChild(pb);
      root.appendChild(h1);
      root.appendChild(wrapper);
      return wrapper;
      }
      function collectHeadingIdsIn(element) {
      const ids = new Set();
      if (!element) return ids;
      const hs = element.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]");
      for (const h of hs) {
      const id = h.getAttribute("id");
      if (id) ids.add(id);
      }
      return ids;
      }
      function normalizeSpaces(s) {
      return String(s || "").replace(/\s+/g, " ").trim();
      }
      function headingToTocText(headingEl) {
      const parts = [];
      function walk(node) {
      if (!node) return;
      if (node.nodeType === Node.TEXT_NODE) {
      parts.push(node.nodeValue);
      return;
      }
      if (node.nodeType === Node.ELEMENT_NODE) {
      const el = node;
      if (el.classList && (el.classList.contains("katex") || el.classList.contains("katex--inline"))) {
      const visible = el.querySelector(".katex-html");
      if (visible) parts.push(visible.textContent);
      return;
      }
      if (el.tagName === "ANNOTATION") return;
      for (const child of el.childNodes) walk(child);
      }
      }
      walk(headingEl);
      return normalizeSpaces(parts.join(""));
      }
      function fixTocKaTeX(tocRootEl) {
      if (!tocRootEl) return;
      const links = tocRootEl.querySelectorAll('a[href^="#"]');
      for (const a of links) {
      const href = a.getAttribute("href");
      if (!href || href.length < 2) continue;
      const id = decodeURIComponent(href.slice(1));
      const heading = document.getElementById(id);
      if (!heading) continue;
      const txt = headingToTocText(heading);
      if (txt) a.textContent = txt;
      }
      }
      function ensureChildEntryUnderTitle(href, text) {
      const rootUl = findLeftTocRootUl();
      if (!rootUl) return null;
      const topLi = findTopLi(rootUl);
      if (!topLi) return null;
      const nested = ensureNestedUl(topLi);
      let li = null;
      for (const x of nested.querySelectorAll(":scope > li")) {
      const a = x.querySelector(":scope > a");
      if (a && a.getAttribute("href") === href) {
      li = x;
      break;
      }
      }
      if (!li) {
      li = makeTocLi(href, text);
      nested.appendChild(li);
      }
      return li;
      }
      function ensureReferencesInTocIfExists(referencesExist) {
      if (!referencesExist) return null;
      return ensureChildEntryUnderTitle("#references", "References");
      }
      function ensureAppendixInTocAndRegroup(appendixWrapper) {
      const leftRoot = findLeftTocRootUl();
      if (!leftRoot) return null;
      const topLi = findTopLi(leftRoot);
      if (!topLi) return null;
      const nested = ensureNestedUl(topLi);
      let appendixLi = null;
      for (const li of nested.querySelectorAll(":scope > li")) {
      const a = li.querySelector(":scope > a");
      if (a && a.getAttribute("href") === "#appendix") {
      appendixLi = li;
      break;
      }
      }
      if (!appendixLi) {
      appendixLi = makeTocLi("#appendix", "Appendix");
      nested.appendChild(appendixLi);
      }
      const ids = collectHeadingIdsIn(appendixWrapper);
      ids.delete("appendix");
      if (ids.size === 0) return appendixLi;
      const appendixUl = ensureNestedUl(appendixLi);
      const links = leftRoot.querySelectorAll('a[href^="#"]');
      const toMove = [];
      for (const a of links) {
      const href = a.getAttribute("href");
      if (!href || href.length < 2) continue;
      if (href === "#appendix") continue;
      const id = decodeURIComponent(href.slice(1));
      if (!ids.has(id)) continue;
      const li = a.closest("li");
      if (!li) continue;
      if (appendixLi.contains(li)) continue;
      toMove.push(li);
      }
      const seen = new Set();
      for (const li of toMove) {
      const a = li.querySelector(":scope > a[href^='#']");
      const href = a ? a.getAttribute("href") : null;
      if (!href) continue;
      if (seen.has(href)) continue;
      seen.add(href);
      if (li.parentNode) li.parentNode.removeChild(li);
      appendixUl.appendChild(li);
      }
      return appendixLi;
      }
      function findLiByHref(rootUl, href) {
      if (!rootUl) return null;
      const a = rootUl.querySelector('a[href="' + href + '"]');
      return a ? a.closest("li") : null;
      }
      function moveLiToRootBottom(rootUl, li) {
      if (!rootUl || !li) return;
      if (li.parentNode) li.parentNode.removeChild(li);
      rootUl.appendChild(li);
      }
      function promoteReferencesAndAppendixToRoot() {
      const rootUl = findLeftTocRootUl();
      if (!rootUl) return;
      const referencesLi = findLiByHref(rootUl, "#references");
      if (referencesLi) moveLiToRootBottom(rootUl, referencesLi);
      const appendixLi = findLiByHref(rootUl, "#appendix");
      if (appendixLi) moveLiToRootBottom(rootUl, appendixLi);
      }
      function ensureTableOfContentsChild(shouldInsert) {
      if (!shouldInsert) return;
      const rootUl = findLeftTocRootUl();
      if (!rootUl) return;
      const topLi = findTopLi(rootUl);
      if (!topLi) return;
      const nested = ensureNestedUl(topLi);
      const exists = Array.from(nested.querySelectorAll(":scope > li > a"))
      .some(a => a.getAttribute("href") === "#table-of-contents");
      if (!exists) {
      nested.insertBefore(makeTocLi("#table-of-contents", "Table of Contents"), nested.firstChild);
      }
      }
      function buildTocPageFromLeftToc() {
      const marker = document.querySelector(".stackedit__html .page-toc");
      if (!marker) return;
      const leftToc = findLeftTocContainer();
      const leftUl = leftToc ? leftToc.querySelector(":scope > ul") : null;
      if (!leftUl) return;
      const wrapper = document.createElement("div");
      wrapper.className = "page-toc-wrapper";
      const h2 = document.createElement("h2");
      h2.id = "table-of-contents";
      h2.textContent = "Table of Contents";
      const tocBox = document.createElement("div");
      tocBox.className = "stackedit__toc";
      tocBox.appendChild(leftUl.cloneNode(true));
      fixTocKaTeX(tocBox);
      const pb = document.createElement("div");
      pb.className = "page-break";
      wrapper.appendChild(h2);
      wrapper.appendChild(tocBox);
      wrapper.appendChild(pb);
      marker.parentNode.replaceChild(wrapper, marker);
      }
      function run() {
      const hasPageToc = !!document.querySelector(".stackedit__html .page-toc");
      const referencesExist = ensureReferencesHeadingFromFootnotes();
      const appendixWrapper = moveAppendixRangeToEnd();
      ensureTableOfContentsChild(hasPageToc);
      ensureReferencesInTocIfExists(referencesExist);
      if (appendixWrapper) {
      ensureAppendixInTocAndRegroup(appendixWrapper);
      }
      const leftTocContainer = findLeftTocContainer();
      fixTocKaTeX(leftTocContainer);
      promoteReferencesAndAppendixToRoot();
      fixTocKaTeX(leftTocContainer);
      buildTocPageFromLeftToc();
      }
      if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", run);
      } else {
      run();
      }
      })();
      </script>
      <script>
      (function () {
      function unwrap(node) {
      if (!node || !node.parentNode) return;
      const parent = node.parentNode;
      while (node.firstChild) parent.insertBefore(node.firstChild, node);
      parent.removeChild(node);
      }
      function wrapTable(table) {
      const wrapper = document.createElement("div");
      wrapper.className = "print-table-fit";
      table.parentNode.insertBefore(wrapper, table);
      wrapper.appendChild(table);
      return wrapper;
      }
      function fitTablesForPrint() {
      const root = document.querySelector(".stackedit__right .stackedit__html") || document.body;
      const contentWidth = root.getBoundingClientRect().width;
      document.querySelectorAll(".print-table-fit").forEach(unwrap);
      const tables = document.querySelectorAll("table");
      for (const table of tables) {
      const rect = table.getBoundingClientRect();
      if (!rect.width) continue;
      const wrapper = wrapTable(table);
      const wrect = table.getBoundingClientRect();
      if (wrect.width <= contentWidth) continue;
      const scale = Math.max(0.5, Math.min(1.0, (contentWidth - 8) / wrect.width));
      wrapper.style.transform = "scale(" + scale.toFixed(4) + ")";
      wrapper.style.width = (100 / scale).toFixed(4) + "%";
      wrapper.style.marginBottom = "0.6rem";
      }
      }
      function resetTablesAfterPrint() {
      document.querySelectorAll(".print-table-fit").forEach(unwrap);
      }
      window.addEventListener("beforeprint", fitTablesForPrint);
      window.addEventListener("afterprint", resetTablesAfterPrint);
      const mql = window.matchMedia("print");
      if (mql && typeof mql.addEventListener === "function") {
      mql.addEventListener("change", (e) => {
      if (e.matches) fitTablesForPrint();
      else resetTablesAfterPrint();
      });
      }
      })();
      </script>
    </body>
  </html>
